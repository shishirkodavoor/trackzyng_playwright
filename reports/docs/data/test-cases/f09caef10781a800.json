{"uid":"f09caef10781a800","name":"Security: XSS payloads are not executed or reflected","fullName":"tests.test_security.TestSecurity#test_xss_attack_prevention","historyId":"f90578d38430baee42c9ba535397453c","time":{"start":1766479419082,"stop":1766479430499,"duration":11417},"description":"Submit XSS-like payloads and verify they are not reflected raw in the DOM and do not cause a successful login.","descriptionHtml":"<p>Submit XSS-like payloads and verify they are not reflected raw in the DOM and do not cause a successful login.</p>\n","status":"broken","statusMessage":"NameError: name 're' is not defined. Did you forget to import 're'?","statusTrace":"self = <tests.test_security.TestSecurity object at 0x1037f3110>\npage = <Page url='https://portal.trackzyng.codezyng.com/'>\n\n    def test_xss_attack_prevention(self, page):\n        \"\"\"Test XSS attack prevention.\"\"\"\n        allure.dynamic.title(\"Security: XSS payloads are not executed or reflected\")\n        allure.dynamic.description(\"Submit XSS-like payloads and verify they are not reflected raw in the DOM and do not cause a successful login.\")\n        ensure_fresh_session(page)\n        login = LoginPage(page)\n        login.open()\n    \n        xss_payloads = [\n            \"<script>alert('XSS')</script>\",\n            \"<img src=x onerror=alert('XSS')>\",\n            \"javascript:alert('XSS')\",\n            \"<svg onload=alert('XSS')>\",\n            \"<body onload=alert('XSS')>\",\n        ]\n    \n        for xss in xss_payloads:\n            ensure_fresh_session(page)\n            login.open()\n            login.login(xss, \"test1234\", check_password=False)\n            page.wait_for_timeout(2000)\n            # Should not execute script nor log in\n            assert \"/dashboard\" not in page.url, f\"XSS payload should not result in login: {xss}\"\n            content = page.content().lower()\n            # For payloads with tags, ensure the exact payload isn't reflected verbatim\n            if '<' in xss or '>' in xss:\n                assert xss.lower() not in content, f\"Page should not reflect raw XSS payloads in content for payload: {xss}\"\n            # For javascript: style payloads, ensure they do not appear in href/src or event attributes (which could be executable)\n            elif 'javascript:' in xss.lower():\n>               assert not re.search(r\"href\\s*=\\s*[\\\"']\\s*javascript:\", content), \\\n                    f\"javascript: URLs reflected in href are dangerous for payload: {xss}\"\nE               NameError: name 're' is not defined. Did you forget to import 're'?\n\ntests/test_security.py:62: NameError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"page","time":{"start":1766479418778,"stop":1766479419081,"duration":303},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"attachmentsCount":0},{"name":"pytestconfig","time":{"start":1766479418778,"stop":1766479418778,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"attachmentsCount":0},{"name":"_verify_url","time":{"start":1766479418778,"stop":1766479418778,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"attachmentsCount":0},{"name":"base_url","time":{"start":1766479418778,"stop":1766479418778,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"attachmentsCount":0},{"name":"delete_output_dir","time":{"start":1766479418778,"stop":1766479418778,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"attachmentsCount":0}],"afterStages":[{"name":"page::0","time":{"start":1766479430608,"stop":1766479430628,"duration":20},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"attachmentsCount":0}],"labels":[{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_security"},{"name":"subSuite","value":"TestSecurity"},{"name":"host","value":"Shishirs-Mac-mini.local"},{"name":"thread","value":"19856-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_security"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":true,"retry":true,"extra":{"categories":[],"tags":[]},"source":"f09caef10781a800.json","parameterValues":[]}