{"uid":"4a5c5d820db4e644","name":"Security: XSS payloads are not executed or reflected","fullName":"tests.test_security.TestSecurity#test_xss_attack_prevention","historyId":"f90578d38430baee42c9ba535397453c","time":{"start":1766479380961,"stop":1766479392180,"duration":11219},"description":"Submit XSS-like payloads and verify they are not reflected raw in the DOM and do not cause a successful login.","descriptionHtml":"<p>Submit XSS-like payloads and verify they are not reflected raw in the DOM and do not cause a successful login.</p>\n","status":"failed","statusMessage":"AssertionError: Page should not reflect raw XSS payloads in content for payload: javascript:alert('XSS')\nassert \"javascript:alert('xss')\" not in '<!doctype h...body></html>'\n  \"javascript:alert('xss')\" is contained here:\n  ?           ^\n    t\" value=\"javascript:alert('xss')\" style=\"font-family: roboto;\"><fieldset aria-hidden=\"true\" class=\"muioutlinedinput-notchedoutline css-5v2ak0\"><legend class=\"css-w1u3ce\"><span>enter mobile number or email</span></legend></fieldset></div></div><p class=\"muitypography-root muitypography-body1 css-11wsnih\">user not found in any realm</p><button class=\"muibuttonbase-root muibutton-root muibutton-contained muibutton-containedprimary muibutton-sizemedium muibutton-containedsizemedium muibutton-colorprimary muibutton-ful...\n  \n  ...Full output truncated (5 lines hidden), use '-vv' to show","statusTrace":"self = <tests.test_security.TestSecurity object at 0x103727110>\npage = <Page url='https://portal.trackzyng.codezyng.com/'>\n\n    def test_xss_attack_prevention(self, page):\n        \"\"\"Test XSS attack prevention.\"\"\"\n        allure.dynamic.title(\"Security: XSS payloads are not executed or reflected\")\n        allure.dynamic.description(\"Submit XSS-like payloads and verify they are not reflected raw in the DOM and do not cause a successful login.\")\n        ensure_fresh_session(page)\n        login = LoginPage(page)\n        login.open()\n    \n        xss_payloads = [\n            \"<script>alert('XSS')</script>\",\n            \"<img src=x onerror=alert('XSS')>\",\n            \"javascript:alert('XSS')\",\n            \"<svg onload=alert('XSS')>\",\n            \"<body onload=alert('XSS')>\",\n        ]\n    \n        for xss in xss_payloads:\n            ensure_fresh_session(page)\n            login.open()\n            login.login(xss, \"test1234\", check_password=False)\n            page.wait_for_timeout(2000)\n            # Should not execute script nor log in\n            assert \"/dashboard\" not in page.url, f\"XSS payload should not result in login: {xss}\"\n            content = page.content().lower()\n            # Ensure the exact payload isn't reflected verbatim; presence of unrelated script tags is acceptable\n>           assert xss.lower() not in content, f\"Page should not reflect raw XSS payloads in content for payload: {xss}\"\nE           AssertionError: Page should not reflect raw XSS payloads in content for payload: javascript:alert('XSS')\nE           assert \"javascript:alert('xss')\" not in '<!doctype h...body></html>'\nE             \"javascript:alert('xss')\" is contained here:\nE             ?           ^\nE               t\" value=\"javascript:alert('xss')\" style=\"font-family: roboto;\"><fieldset aria-hidden=\"true\" class=\"muioutlinedinput-notchedoutline css-5v2ak0\"><legend class=\"css-w1u3ce\"><span>enter mobile number or email</span></legend></fieldset></div></div><p class=\"muitypography-root muitypography-body1 css-11wsnih\">user not found in any realm</p><button class=\"muibuttonbase-root muibutton-root muibutton-contained muibutton-containedprimary muibutton-sizemedium muibutton-containedsizemedium muibutton-colorprimary muibutton-ful...\nE             \nE             ...Full output truncated (5 lines hidden), use '-vv' to show\n\ntests/test_security.py:58: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"base_url","time":{"start":1766479380696,"stop":1766479380696,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_verify_url","time":{"start":1766479380696,"stop":1766479380696,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"page","time":{"start":1766479380696,"stop":1766479380960,"duration":264},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1766479380696,"stop":1766479380696,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"pytestconfig","time":{"start":1766479380696,"stop":1766479380696,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false}],"afterStages":[{"name":"page::0","time":{"start":1766479392286,"stop":1766479392311,"duration":25},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_security"},{"name":"subSuite","value":"TestSecurity"},{"name":"host","value":"Shishirs-Mac-mini.local"},{"name":"thread","value":"19674-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_security"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":true,"retry":true,"extra":{"categories":[],"tags":[]},"source":"4a5c5d820db4e644.json","parameterValues":[]}