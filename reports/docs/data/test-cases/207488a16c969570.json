{"uid":"207488a16c969570","name":"Security: XSS payloads are not executed or reflected","fullName":"tests.test_security.TestSecurity#test_xss_attack_prevention","historyId":"f90578d38430baee42c9ba535397453c","time":{"start":1766479360989,"stop":1766479365854,"duration":4865},"description":"Submit XSS-like payloads and verify they are not reflected raw in the DOM and do not cause a successful login.","descriptionHtml":"<p>Submit XSS-like payloads and verify they are not reflected raw in the DOM and do not cause a successful login.</p>\n","status":"failed","statusMessage":"AssertionError: Page should not reflect raw XSS payloads in content for payload: <script>alert('XSS')</script>\nassert ('<script' not in '<!doctype h...body></html>'\n  '<script' is contained here:\n    itle>\n        <script type=\"module\" crossorigin=\"\" src=\"/assets/index-6btaneob.js\"></script>\n  ?     +++++++\n        <link rel=\"stylesheet\" crossorigin=\"\" href=\"/assets/index-aldp7z3i.css\">\n      <style data-emotion=\"css-global\" data-s=\"\"></style><style data-emotion=\"css-global\" data-s=\"\"></style><style data-emotion=\"css\" data-s=\"\"></style><script type=\"text/javascript\" src=\"https://maps.googleapis.com/maps/api/js?key=aizasydbdjel7zc0btkbngybyvz9owf7pkcv4-q&amp;v=weekly&amp;loading=async&amp;callback=initmap\" id=\"script-loader\" async=\"\" data-state=\"ready\"></script><scrip...\n  \n  ...Full output truncated (6 lines hidden), use '-vv' to show)","statusTrace":"self = <tests.test_security.TestSecurity object at 0x107e4b110>\npage = <Page url='https://portal.trackzyng.codezyng.com/'>\n\n    def test_xss_attack_prevention(self, page):\n        \"\"\"Test XSS attack prevention.\"\"\"\n        allure.dynamic.title(\"Security: XSS payloads are not executed or reflected\")\n        allure.dynamic.description(\"Submit XSS-like payloads and verify they are not reflected raw in the DOM and do not cause a successful login.\")\n        ensure_fresh_session(page)\n        login = LoginPage(page)\n        login.open()\n    \n        xss_payloads = [\n            \"<script>alert('XSS')</script>\",\n            \"<img src=x onerror=alert('XSS')>\",\n            \"javascript:alert('XSS')\",\n            \"<svg onload=alert('XSS')>\",\n            \"<body onload=alert('XSS')>\",\n        ]\n    \n        for xss in xss_payloads:\n            ensure_fresh_session(page)\n            login.open()\n            login.login(xss, \"test1234\", check_password=False)\n            page.wait_for_timeout(2000)\n            # Should not execute script nor log in\n            assert \"/dashboard\" not in page.url, f\"XSS payload should not result in login: {xss}\"\n            content = page.content().lower()\n>           assert '<script' not in content and 'onerror' not in content and 'javascript:' not in content, \\\n                f\"Page should not reflect raw XSS payloads in content for payload: {xss}\"\nE           AssertionError: Page should not reflect raw XSS payloads in content for payload: <script>alert('XSS')</script>\nE           assert ('<script' not in '<!doctype h...body></html>'\nE             '<script' is contained here:\nE               itle>\nE                   <script type=\"module\" crossorigin=\"\" src=\"/assets/index-6btaneob.js\"></script>\nE             ?     +++++++\nE                   <link rel=\"stylesheet\" crossorigin=\"\" href=\"/assets/index-aldp7z3i.css\">\nE                 <style data-emotion=\"css-global\" data-s=\"\"></style><style data-emotion=\"css-global\" data-s=\"\"></style><style data-emotion=\"css\" data-s=\"\"></style><script type=\"text/javascript\" src=\"https://maps.googleapis.com/maps/api/js?key=aizasydbdjel7zc0btkbngybyvz9owf7pkcv4-q&amp;v=weekly&amp;loading=async&amp;callback=initmap\" id=\"script-loader\" async=\"\" data-state=\"ready\"></script><scrip...\nE             \nE             ...Full output truncated (6 lines hidden), use '-vv' to show)\n\ntests/test_security.py:57: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"page","time":{"start":1766479360378,"stop":1766479360989,"duration":611},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"pytestconfig","time":{"start":1766479360378,"stop":1766479360378,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"base_url","time":{"start":1766479360378,"stop":1766479360378,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_verify_url","time":{"start":1766479360378,"stop":1766479360378,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1766479360378,"stop":1766479360378,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false}],"afterStages":[{"name":"page::0","time":{"start":1766479365961,"stop":1766479365986,"duration":25},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_security"},{"name":"subSuite","value":"TestSecurity"},{"name":"host","value":"Shishirs-Mac-mini.local"},{"name":"thread","value":"19490-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_security"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":true,"retry":true,"extra":{"categories":[],"tags":[]},"source":"207488a16c969570.json","parameterValues":[]}